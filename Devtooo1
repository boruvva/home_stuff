#!/bin/bash

# Create test files
echo "Hello World" > file1.txt
echo "Hello Universe" > file2.txt
echo "Hello World" > file3.txt
echo -n -e '\x00\x01\x02\x03' > file1.bin
echo -n -e '\x04\x05\x06\x07' > file2.bin
echo -n -e '\x00\x01\x02\x03' > file3.bin

# Function to check if a file is a text file
is_text_file() {
    file --mime "$1" | grep -q 'charset=us-ascii\|charset=utf-8'
}

# Run tests and compare with expected results
run_test() {
    local test_name=$1
    local fileA=$2
    local fileB=$3
    local expected_output=$4

    echo "Running $test_name..."
    actual_output=$(./compare_files.sh "$fileA" "$fileB")
    if [ "$actual_output" == "$expected_output" ]; then
        echo "$test_name passed."
    else
        echo "$test_name failed."
        echo "Expected: $expected_output"
        echo "Got: $actual_output"
    fi
}

# Test cases
run_test "Test 1: Identical text files" file1.txt file3.txt "Files are identical"
run_test "Test 2: Different text files" file1.txt file2.txt "Files are different"
run_test "Test 3: Identical binary files" file1.bin file3.bin "Files are identical"
run_test "Test 4: Different binary files" file1.bin file2.bin "Files are different"
run_test "Test 5: Text file vs Binary file" file1.txt file1.bin "Files are different"
run_test "Test 6: At least one file is text" file1.txt file2.bin "Files are different"

echo "All tests completed."
