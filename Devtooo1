#!/bin/bash

# Function to run a test case
run_test() {
    local min_size=$1
    local expected_output=$2

    echo "Running test with min_size=$min_size..."
    actual_output=$(./GetDirectorySizes.sh $min_size)
    if [ "$actual_output" == "$expected_output" ]; then
        echo "Test passed."
    else
        echo "Test failed."
        echo "Expected: $expected_output"
        echo "Got: $actual_output"
    fi
}

# Test setup
mkdir -p small_dir
mkdir -p medium_dir
mkdir -p large_dir
dd if=/dev/zero of=small_dir/file1 bs=1M count=1
dd if=/dev/zero of=medium_dir/file2 bs=1M count=5
dd if=/dev/zero of=large_dir/file3 bs=1M count=10

# Expected outputs
expected_output_0M="10M ./large_dir/\n5.0M ./medium_dir/\n1.0M ./small_dir/"
expected_output_1M="10M ./large_dir/\n5.0M ./medium_dir/"
expected_output_10M="10M ./large_dir/"

# Run tests
run_test "0M" "$expected_output_0M"
run_test "1M" "$expected_output_1M"
run_test "10M" "$expected_output_10M"

# Clean up
rm -rf large_dir small_dir medium_dir
echo "All tests completed and test files removed."
