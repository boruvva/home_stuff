#!/bin/bash

# Function to create test files
create_test_files() {
    mkdir -p test_dir
    dd if=/dev/zero of=test_dir/testfile1GB bs=1M count=1024
    dd if=/dev/zero of=test_dir/testfile100MB bs=1M count=100
}

# Function to run a test case
run_test() {
    local filename=$1
    local size=$2
    local expected_output=$3

    echo "Running test for file '$filename' with size '$size'..."
    actual_output=$(../split-files.sh test_dir/$filename $size 2>&1)
    if [ "$actual_output" == "$expected_output" ]; then
        echo "Test passed."
    else
        echo "Test failed."
        echo "Expected: $expected_output"
        echo "Got: $actual_output"
    fi
}

# Create test files
create_test_files

# Expected outputs
expected_output_1="I am checking file test_dir/testfile1GB"
expected_output_2="I am checking file test_dir/testfile100MB"
expected_output_3="Can't find input file. Please provide filename"

# Run tests
run_test "testfile1GB" "" "$expected_output_1"
run_test "testfile100MB" "" "$expected_output_2"
run_test "non_existent_file" "" "$expected_output_3"

# Clean up test files and directories
rm -rf test_dir
echo "All tests completed and test files removed."
